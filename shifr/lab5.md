# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ5

## –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –Ω–∞ C# —Ä–µ–∞–ª–∏–∑—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ—Å—Ç—ã–º–∏ —á–∏—Å–ª–∞–º–∏ –∏ –æ–±–º–µ–Ω–æ–º –∫–ª—é—á–∞–º–∏:
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–æ–ª—å—à–æ–≥–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —á–∏—Å–ª–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–µ—Å—Ç–∞ –†–∞–±–∏–Ω–∞-–ú–∏–ª–ª–µ—Ä–∞.
- –í—ã–≤–æ–¥ –≤—Å–µ—Ö –ø—Ä–æ—Å—Ç—ã—Ö —á–∏—Å–µ–ª –≤ –∑–∞–¥–∞–Ω–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ.
- –ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–æ–±—Ä–∞–∑–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π –ø–æ –º–æ–¥—É–ª—é –ø—Ä–æ—Å—Ç–æ–≥–æ —á–∏—Å–ª–∞.
- –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏ –ø–æ —Å—Ö–µ–º–µ –î–∏—Ñ—Ñ–∏-–•–µ–ª–ª–º–∞–Ω–∞.

## –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–æ–ª—å—à–æ–≥–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —á–∏—Å–ª–∞

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏—Ç –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ —Ç–µ—Å—Ç–µ –†–∞–±–∏–Ω–∞-–ú–∏–ª–ª–µ—Ä–∞.
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ `n`-–±–∏—Ç–Ω–æ–µ —á–∏—Å–ª–æ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ–≥–æ –Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ç—É.
- –í—ã–≤–æ–¥–∏—Ç—Å—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –∏ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

### –í—ã–≤–æ–¥ –ø—Ä–æ—Å—Ç—ã—Ö —á–∏—Å–µ–ª –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –Ω–∏–∂–Ω—é—é –∏ –≤–µ—Ä—Ö–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É –¥–∏–∞–ø–∞–∑–æ–Ω–∞.
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ —á–∏—Å–ª–∞ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ç—É.
- –í—ã–≤–æ–¥–∏—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Å—Ç—ã—Ö —á–∏—Å–µ–ª –∏ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

### –ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–æ–±—Ä–∞–∑–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –ø—Ä–æ—Å—Ç–æ–µ —á–∏—Å–ª–æ `p`.
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∏—â–µ—Ç –ø–µ—Ä–≤—ã–µ 100 –ø–µ—Ä–≤–æ–æ–±—Ä–∞–∑–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π —á–∏—Å–ª–∞ `p`.
- –í—ã–≤–æ–¥–∏—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∫–æ—Ä–Ω–∏ –∏ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

### –û–±–º–µ–Ω –∫–ª—é—á–∞–º–∏ –ø–æ –î–∏—Ñ—Ñ–∏-–•–µ–ª–ª–º–∞–Ω—É

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç (–∏–ª–∏ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—É—Å—Ç—ã–º) –ø—Ä–æ—Å—Ç—ã–µ —á–∏—Å–ª–∞ `p` –∏ `g`.
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ `a` –∏ `b`.
- –í—ã—á–∏—Å–ª—è—é—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–µ –∫–ª—é—á–∏ `A = g^a mod p` –∏ `B = g^b mod p`.
- –í—ã—á–∏—Å–ª—è—é—Ç—Å—è –æ–±—â–∏–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á `K = B^a mod p` (–¥–ª—è –ê–ª–∏—Å—ã) –∏ `K = A^b mod p` (–¥–ª—è –ë–æ–±–∞).

## —Ç–µ–æ—Ä–∏—è
üß™ 1. –¢–µ—Å—Ç –†–∞–±–∏–Ω–∞-–ú–∏–ª–ª–µ—Ä–∞ –Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ç—É

üîç –û–ø–∏—Å–∞–Ω–∏–µ

–¢–µ—Å—Ç –†–∞–±–∏–Ω–∞-–ú–∏–ª–ª–µ—Ä–∞ ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —á–∏—Å–ª–æ $n$ –ø—Ä–æ—Å—Ç—ã–º.

‚öô –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ—Å—Ç –†–∞–±–∏–Ω–∞-–ú–∏–ª–ª–µ—Ä–∞?

–†–∞–∑–ª–æ–∂–µ–Ω–∏–µ —á–∏—Å–ª–∞ $n - 1$–ü—Ä–æ—Å—Ç—ã–µ —á–∏—Å–ª–∞ $p$ –æ–±–ª–∞–¥–∞—é—Ç —Å–≤–æ–π—Å—Ç–≤–æ–º, —á—Ç–æ –ª—é–±–æ–µ —á–∏—Å–ª–æ $n - 1$ –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –≤ –≤–∏–¥–µ:



–≥–¥–µ:

$d$ ‚Äî –Ω–µ—á—ë—Ç–Ω–æ–µ —á–∏—Å–ª–æ,

$s$ ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å –¥–≤–æ–π–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –¥–µ–ª–∏—Ç $n-1$.

–í—ã–±–æ—Ä —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å–≤–∏–¥–µ—Ç–µ–ª—è $a$

–í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ $a$ –∏–∑ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ $[2, n-2]$.

–ï—Å–ª–∏ $a^d \mod n = 1$, —Ç–æ —á–∏—Å–ª–æ $n$ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ç–µ—Å—Ç.

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–µ–ø–µ–Ω–Ω—ã—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏–π

–ï—Å–ª–∏ $a^d \mod n \neq 1$, –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã—á–∏—Å–ª—è–µ–º:



–¥–ª—è $r = 0, 1, ..., s-1$.

–ï—Å–ª–∏ –≤ –∫–∞–∫–æ–º-—Ç–æ —à–∞–≥–µ —ç—Ç–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–∞—ë—Ç $n - 1$, —Ç–æ $n$ –ø—Ä–æ—Ö–æ–¥–∏—Ç —ç—Ç–æ—Ç —Ä–∞—É–Ω–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏.

–ï—Å–ª–∏ –∂–µ –Ω–µ—Ç, —Ç–æ $n$ —Å–æ—Å—Ç–∞–≤–Ω–æ–µ (–Ω–µ–ø—Ä–æ—Å—Ç–æ–µ).

–ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ–≤—Ç–æ—Ä—è–µ–º —Ç–µ—Å—Ç –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π $a$.

–ï—Å–ª–∏ –≤–æ –≤—Å–µ—Ö —Å–ª—É—á–∞—è—Ö $n$ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ç–µ—Å—Ç, —Ç–æ –æ–Ω–æ —Å –≤—ã—Å–æ–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Å—Ç–æ–µ.

üìå –≠—Ç–æ—Ç —Ç–µ—Å—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏.

üîë 2. –°—Ö–µ–º–∞ –î–∏—Ñ—Ñ–∏-–•–µ–ª–ª–º–∞–Ω–∞

üèó –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç?

–í—ã–±–æ—Ä –ø—É–±–ª–∏—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–í—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–µ —á–∏—Å–ª–æ $p$.

–í—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–µ—Ä–≤–æ–æ–±—Ä–∞–∑–Ω—ã–π –∫–æ—Ä–µ–Ω—å $g$ –ø–æ –º–æ–¥—É–ª—é $p$.

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π

–ê–ª–∏—Å–∞ –≤—ã–±–∏—Ä–∞–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ $a$ (–∑–∞–∫—Ä—ã—Ç—ã–π –∫–ª—é—á).

–ë–æ–± –≤—ã–±–∏—Ä–∞–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ $b$ (–∑–∞–∫—Ä—ã—Ç—ã–π –∫–ª—é—á).

–ê–ª–∏—Å–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç $A = g^a \mod p$ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ë–æ–±—É.

–ë–æ–± –≤—ã—á–∏—Å–ª—è–µ—Ç $B = g^b \mod p$ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ê–ª–∏—Å–µ.

–û–±—â–∏–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á

–ê–ª–∏—Å–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç —Å–µ–∫—Ä–µ—Ç:



–ë–æ–± –≤—ã—á–∏—Å–ª—è–µ—Ç —Ç–æ—Ç –∂–µ —Å–∞–º—ã–π —Å–µ–∫—Ä–µ—Ç:



–≠—Ç–æ—Ç –∫–ª—é—á –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

üìå –î–∏—Ñ—Ñ–∏-–•–µ–ª–ª–º–∞–Ω –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º–∞ –∏ –±–µ–∑–æ–ø–∞—Å–µ–Ω –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö $p$.

üî¢ 3. –ü–µ—Ä–≤–æ–æ–±—Ä–∞–∑–Ω—ã–π –∫–æ—Ä–µ–Ω—å

üîç –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

–ü–µ—Ä–≤–æ–æ–±—Ä–∞–∑–Ω—ã–π –∫–æ—Ä–µ–Ω—å $g$ –ø–æ –º–æ–¥—É–ª—é $p$ ‚Äî —ç—Ç–æ —á–∏—Å–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤—Å–µ —á–∏—Å–ª–∞ –æ—Ç 1 –¥–æ $p-1$ –ø—Ä–∏ –≤–æ–∑–≤–µ–¥–µ–Ω–∏–∏ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç–µ–ø–µ–Ω–∏.

üìå –§–æ—Ä–º—É–ª–∞

–ß–∏—Å–ª–æ $g$ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–≤–æ–æ–±—Ä–∞–∑–Ω—ã–º –∫–æ—Ä–Ω–µ–º –ø–æ –º–æ–¥—É–ª—é $p$, –µ—Å–ª–∏:



—Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —á–∏—Å–ª–∞ –æ—Ç 1 –¥–æ $p-1$ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π.

üèó –ü—Ä–∏–º–µ—Ä

–î–ª—è $p = 7$:

$g = 2$:



–ù–µ –ø–µ—Ä–≤–æ–æ–±—Ä–∞–∑–Ω—ã–π –∫–æ—Ä–µ–Ω—å.

$g = 3$:





–≠—Ç–æ –ø–µ—Ä–≤–æ–æ–±—Ä–∞–∑–Ω—ã–π –∫–æ—Ä–µ–Ω—å, —Ç–∞–∫ –∫–∞–∫ –ø–æ—Ä–æ–∂–¥–∞–µ—Ç –≤—Å–µ —á–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 6.

üìå –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å—Ö–µ–º–µ –î–∏—Ñ—Ñ–∏-–•–µ–ª–ª–º–∞–Ω–∞.


–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

- `GenerateRandomBigInteger(int bitLength)` ‚Äì –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ `n`-–±–∏—Ç–Ω–æ–µ —á–∏—Å–ª–æ.
- `GenerateRandomPrime(int bitLength)` ‚Äì –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `n`-–±–∏—Ç–Ω–æ–µ –ø—Ä–æ—Å—Ç–æ–µ —á–∏—Å–ª–æ.
- `IsProbablyPrime(BigInteger number, int iterations)` ‚Äì —Ç–µ—Å—Ç –†–∞–±–∏–Ω–∞-–ú–∏–ª–ª–µ—Ä–∞.
- `FindPrimitiveRoots()` ‚Äì –ø–æ–∏—Å–∫ –ø–µ—Ä–≤–æ–æ–±—Ä–∞–∑–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π.
- `DiffieHellmanKeyExchange()` ‚Äì –æ–±–º–µ–Ω –∫–ª—é—á–∞–º–∏ –ø–æ —Å—Ö–µ–º–µ –î–∏—Ñ—Ñ–∏-–•–µ–ª–ª–º–∞–Ω–∞.
